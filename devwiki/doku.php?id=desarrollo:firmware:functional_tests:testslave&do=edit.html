<!DOCTYPE html>
<html lang="es" dir="ltr" class="no-js">
<head>
    <meta charset="utf-8" />
    <title>desarrollo:firmware:functional_tests:testslave []</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki"/>
<meta name="theme-color" content="#008800"/>
<meta name="robots" content="noindex,nofollow"/>
<link rel="search" type="application/opensearchdescription+xml" href="lib/exe/opensearch.php" title=""/>
<link rel="start" href="index.html"/>
<link rel="contents" href="./doku.php%3Fid=desarrollo:firmware:functional_tests:testslave&amp;do=index.html" title="Índice"/>
<link rel="manifest" href="lib/exe/manifest.php"/>
<link rel="alternate" type="application/rss+xml" title="Cambios recientes" href="feed.php"/>
<link rel="alternate" type="application/rss+xml" title="Espacio de nombres actual" href="./feed.php%3Fmode=list&amp;ns=desarrollo:firmware:functional_tests"/>
<link rel="alternate" type="text/html" title="HTML sencillo" href="./doku.php%3Fdo=export_xhtml&amp;id=desarrollo:firmware:functional_tests:testslave.html"/>
<link rel="alternate" type="text/plain" title="Etiquetado Wiki" href="./doku.php%3Fdo=export_raw&amp;id=desarrollo:firmware:functional_tests:testslave"/>
<link rel="stylesheet" href="lib/exe/css.php%3Ft=dokuwiki&amp;tseed=48a4f103b3dd9c0f0740691fb104868a.css"/>
<!--[if gte IE 9]><!-->
<script >/*<![CDATA[*/var NS='desarrollo:firmware:functional_tests';var JSINFO = {"id":"desarrollo:firmware:functional_tests:testslave","namespace":"desarrollo:firmware:functional_tests","ACT":"source","useHeadingNavigation":0,"useHeadingContent":0};
/*!]]>*/</script>
<script src="lib/exe/jquery.php%3Ftseed=34a552433bc33cc9c3bc32527289a0b2"></script>
<script src="lib/exe/js.php%3Ft=dokuwiki&amp;tseed=48a4f103b3dd9c0f0740691fb104868a"></script>
<!--<![endif]-->
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="lib/tpl/dokuwiki/images/favicon.ico" />
<link rel="apple-touch-icon" href="lib/tpl/dokuwiki/images/apple-touch-icon.png" />
    </head>

<body>
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_source tpl_dokuwiki     hasSidebar">

        
<!-- ********** HEADER ********** -->
<header id="dokuwiki__header"><div class="pad group">

    
    <div class="headings group">
        <ul class="a11y skip">
            <li><a href="./doku.php%3Fid=desarrollo:firmware:functional_tests:testslave&amp;do=edit.html#dokuwiki__content">Saltar a contenido</a></li>
        </ul>

        <h1 class="logo"><a href="index.html"  accesskey="h" title="Home [h]"><img src="lib/exe/fetch.php%3Fmedia=logo.png" width="461" height="91" alt="" /> <span></span></a></h1>
            </div>

    <div class="tools group">
        <!-- USER TOOLS -->
                    <div id="dokuwiki__usertools">
                <h3 class="a11y">Herramientas de usuario</h3>
                <ul>
                    <li class="action login"><a href="./doku.php%3Fid=desarrollo:firmware:functional_tests:testslave&amp;do=login&amp;sectok=.html" title="Conectarse" rel="nofollow"><span>Conectarse</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M10 17.25V14H3v-4h7V6.75L15.25 12 10 17.25M8 2h9a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2v-4h2v4h9V4H8v4H6V4a2 2 0 0 1 2-2z"/></svg></a></li>                </ul>
            </div>
        
        <!-- SITE TOOLS -->
        <div id="dokuwiki__sitetools">
            <h3 class="a11y">Herramientas del sitio</h3>
            <form action="index.html" method="get" role="search" class="search doku_form" id="dw__search" accept-charset="utf-8"><input type="hidden" name="do" value="search" /><input type="hidden" name="id" value="desarrollo:firmware:functional_tests:testslave" /><div class="no"><input name="q" type="text" class="edit" title="[F]" accesskey="f" placeholder="Buscar" autocomplete="on" id="qsearch__in" value="" /><button value="1" type="submit" title="Buscar">Buscar</button><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form>            <div class="mobileTools">
                <form action="http://www.proyecto-ciaa.com.ar/devwiki/doku.php" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="desarrollo:firmware:functional_tests:testslave" /><select name="do" class="edit quickselect" title="Herramientas"><option value="">Herramientas</option><optgroup label="Herramientas de la página"><option value="">Ver página</option><option value="revisions">Revisiones antiguas</option><option value="backlink">Enlaces a esta página</option></optgroup><optgroup label="Herramientas del sitio"><option value="recent">Cambios recientes</option><option value="media">Administrador de Ficheros</option><option value="index">Índice</option></optgroup><optgroup label="Herramientas de usuario"><option value="login">Conectarse</option></optgroup></select><button type="submit">&gt;</button></div></form>            </div>
            <ul>
                <li class="action recent"><a href="./doku.php%3Fid=desarrollo:firmware:functional_tests:testslave&amp;do=recent.html" title="Cambios recientes [r]" rel="nofollow" accesskey="r">Cambios recientes</a></li><li class="action media"><a href="./doku.php%3Fid=desarrollo:firmware:functional_tests:testslave&amp;do=media&amp;ns=desarrollo:firmware:functional_tests.html" title="Administrador de Ficheros" rel="nofollow">Administrador de Ficheros</a></li><li class="action index"><a href="./doku.php%3Fid=desarrollo:firmware:functional_tests:testslave&amp;do=index.html" title="Índice [x]" rel="nofollow" accesskey="x">Índice</a></li>            </ul>
        </div>

    </div>

    <!-- BREADCRUMBS -->
            <div class="breadcrumbs">
                                        <div class="trace"><span class="bchead">Traza:</span> <span class="bcsep">•</span> <bdi><a href="./doku.php%3Fid=proyecto:redessociales.html"  class="breadcrumbs" title="proyecto:redessociales">redessociales</a></bdi> <span class="bcsep">•</span> <bdi><a href="./doku.php%3Fid=proyecto:colaborar.html"  class="breadcrumbs" title="proyecto:colaborar">colaborar</a></bdi> <span class="bcsep">•</span> <bdi><a href="./doku.php%3Fid=repo:descripcion:ciaa_nucleo_fsl.html"  class="breadcrumbs" title="repo:descripcion:ciaa_nucleo_fsl">ciaa_nucleo_fsl</a></bdi> <span class="bcsep">•</span> <bdi><a href="./doku.php%3Fid=desarrollo:edu-ciaa:edu-ciaa-nxp:ada:instalacion_windows.html"  class="breadcrumbs" title="desarrollo:edu-ciaa:edu-ciaa-nxp:ada:instalacion_windows">instalacion_windows</a></bdi> <span class="bcsep">•</span> <bdi><a href="./doku.php%3Fid=repo:instalacion:openocd.html"  class="breadcrumbs" title="repo:instalacion:openocd">openocd</a></bdi> <span class="bcsep">•</span> <bdi><a href="./doku.php%3Fid=borradores:micropython_instalar.html"  class="breadcrumbs" title="borradores:micropython_instalar">micropython_instalar</a></bdi> <span class="bcsep">•</span> <bdi><a href="./doku.php%3Fid=desarrollo:edu-ciaa:edu-ciaa-nxp:python:bibliotecas:modulo-pyb.html"  class="breadcrumbs" title="desarrollo:edu-ciaa:edu-ciaa-nxp:python:bibliotecas:modulo-pyb">modulo-pyb</a></bdi> <span class="bcsep">•</span> <bdi><a href="./doku.php%3Fid=desarrollo:edu-ciaa:edu-ciaa-nxp:python:bibliotecas:modulo-utime.html"  class="breadcrumbs" title="desarrollo:edu-ciaa:edu-ciaa-nxp:python:bibliotecas:modulo-utime">modulo-utime</a></bdi> <span class="bcsep">•</span> <bdi><a href="./doku.php%3Fid=desarrollo:edu-ciaa:edu-ciaa-nxp:python:bibliotecas:modulo-modbus.html"  class="breadcrumbs" title="desarrollo:edu-ciaa:edu-ciaa-nxp:python:bibliotecas:modulo-modbus">modulo-modbus</a></bdi> <span class="bcsep">•</span> <span class="curid"><bdi><a href="./doku.php%3Fid=tline:releases_de_ciaa-firmware.html"  class="breadcrumbs" title="tline:releases_de_ciaa-firmware">releases_de_ciaa-firmware</a></bdi></span></div>
                    </div>
    
    <hr class="a11y" />
</div></header><!-- /header -->

        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <main id="dokuwiki__content"><div class="pad group">
                
                <div class="pageId"><span>desarrollo:firmware:functional_tests:testslave</span></div>

                <div class="page group">
                                                            <!-- wikipage start -->
                    
<p>
Esta página es de solo lectura. Puedes ver la fuente pero no puedes cambiarla. Pregunta a tu administrador si crees que esto es incorrecto.
</p>
<div class="editBox" role="application"><div class="toolbar group"><div id="tool__bar" class="tool__bar"></div></div><div id="draft__status" class="draft__status"></div><form id="dw__editform" action="./doku.php%3Fid=desarrollo:firmware:functional_tests:testslave&amp;do=edit.html" method="post" accept-charset="utf-8" class="doku_form"><input type="hidden" name="sectok" value="" /><input type="hidden" name="id" value="desarrollo:firmware:functional_tests:testslave" /><input type="hidden" name="rev" value="0" /><input type="hidden" name="date" value="0" /><input type="hidden" name="prefix" value="." /><input type="hidden" name="suffix" value="" /><input type="hidden" name="changecheck" value="e991deafd82e4e0ce4ecb93867f1a16c" /><input type="hidden" name="target" value="section" /><textarea name="wikitext" type="textarea" dir="auto" tabindex="1" readonly="readonly" cols="80" rows="10" id="wiki__text" class="edit">====== Aplicación testslave ======

===== Resumen =====
La aplicación testslave permite al usuario acceder a todos los dispositivos mediante la escritura y lectura en diferentes direcciones Holding Registers de Modbus. Estas direcciones permiten especificar el path del dispositivo, los argumentos a utilizar en las funciones ioctl(), read() y write(), y ver los resultados obtenidos.

===== Términos, definiciones y abreviaturas =====
  * Holding Register: Tipo de dato para confeccionar un mapa de direcciones. Cada dirección contiene un dato de 16 bits.
  * HR_string: string almacenado en una o más direcciones Modbus. Dado que las direcciones Modbus son de 16 bits los string siempre tienen longitud par. Además los mismo no terminan en el caracter &#039;\0&#039;, dado que se conoce de antemana cuál es la longitud máxima. Cuando el largo un string sea menor al tamaño disponible, siempre se deben completar los caracteres disponibles con el valor 0x00. Los caracteres dentro de una dirección modbus se almacenan de la siguiente manera: 
    * parte alta: primer caracter
    * parte baja: segundo caracter
  * HR_version3: version dada por tres dígitos:
    * primer dirección: major version
    * segunda dirección: minor version
    * tercera dirección: patch version
  * HR_int8_t o HR_uint8_t: Entero de 8 contenido en la parte baja del holding register, la parte alta debe ser completada con el bit de sino.
  * HR_int16_t o HR_uint16_t: Entero de 16 en formato bigendian
  * HR_int32_t o HR_uint32_t: Entero de 32 en formato bigendian, almacenado en 2 holding registers. No se permite acceder a los holding registers de manera individual.


===== Mapa Modbus =====

El mapa Modbus Holding Registers se divide en diferentes secciones según los datos que se pueden acceder.

^ Número de rango ^ Rango ^ Título ^ Descripción ^
| 1 | 0 a 199 | Información general | Se encuentra información del modelo de placa, versión de Firmware y submódulos, etc |
| 2 | 200 a 399 | Ejecución de comandos | Direcciones para indicar la ejecución de un comando determinado |
| 3 | 400 a 499 | Parámetros | Direcciones para inicializar los parámetros utilizados en los diferentes comandos que se pueden ejecutar |
| 4 | 500 a 2499 | Intercambio de datos | Área de memoria para intercambio de datos.|

==== Información general ====

^ Inicio ^ Longitud ^ Tipo ^ r/w ^ Rango de valores ^ Descripción ^
| 0 | 10 | HR_string | r | a-z A-Z 0-9 . : - _ / | Nombre de la placa |
| 50 | 3 | HR_version3 | r | 0.0.0 - 65535.65535.65535 | Versión de testslave |
| 53 | 3 | HR_version3 | r | 0.0.0 - 65535.65535.65535 | Versión de firmware |
| 56 | 3 | HR_version3 | r | 0.0.0 - 65535.65535.65535 | Versión de RTOS |
| 59 | 3 | HR_version3 | r | 0.0.0 - 65535.65535.65535 | Versión de Modbus |

==== Ejecución de comandos ====
En este sector del mapa modbus se encuentran direcciones que al escribir determinados valores, el programa ejecuta cierta acción. Para verificar el fin de dicha acción se debe leer la dirección correspondiente.

^ Inicio ^ Longitud ^ Tipo ^ r/w ^ Rango de valores ^ Descripción ^
| 200 | 1 | HR_int16_t | r/w | 0 - x | w 10 - ejecutar open() |
|::: |::: |::: |::: |::: | w 11 - ejecutar close() |
|::: |::: |::: |::: |::: | w 12 - ejecutar read() |
|::: |::: |::: |::: |::: | w 13 - ejecutar write() |
|::: |::: |::: |::: |::: | w 14 - ejecutar ioctl() |
|::: |::: |::: |::: |::: | w 15 - ejecutar lseek() |
|::: |::: |::: |::: |::: | r 0 - si la ejecución finalizó |
|::: |::: |::: |::: |::: | r !=0 - si la ejecución no finalizó. El valor leído coincide con el la operación que se está ejecutando |

==== Parámetros ====
En este sector se encuentran diferentes parámetros que son utilizados por los comandos descriptos en el sector anterior.

^ Inicio ^ Longitud ^ Tipo ^ r/w ^ Rango de valores ^ Descripción ^
| 400 | 20 | HR_string | r/w | a-z A-Z 0-9 . : - _ / | parámetro **path** de la función open() |
| 420 | 1 | HR_uint8_t | r/w | 0 - 0xFF | parámetro **oflag** de la función open() |
| 421 | 2 | HR_int32_t | r | 0 - 0xFFFFFFFF | valor de **retorno** de las funciones open(), close(), ioctl() read(), write() |
| 423 | 2 | HR_int32_t | r/w | 0 - 0xFFFFFFFF | parámetro **fildes** de las funciones close(), ioctl(), read() write() |
| 425 | 2 | HR_int32_t | r/w | 0 - 0xFFFFFFFF | parámetro **request** de las funciones ioctl()|
| 427 | 2 | HR_int32_t | r/w | 0 - 0xFFFFFFFF | parámetro **param** de las funciones ioctl()|
| 429 | 2 | HR_int32_t | r/w | 0 - 0xFFFFFFFF | parámetro **nbyte** de las funciones read() y write()|
| 431 | 2 | HR_int32_t | r/w | 0 - 0xFFFFFFFF | parámetro **offset** de la función ioctl()|
| 433 | 2 | HR_uint8_t | r/w | 0 - 0xFF | parámetro **whence** de la función ioctl()|





==== Intercambio de datos ====

El área de intercambio de datos no es más que un buffer para leer y escribir datos. Este se utiliza en las operaciones read() y write().
La longitud del buffer depende de la plataforma en la que se corra la aplicación, debido a la memoria disponible en el microcontrolador, por este motivo de debe leer la dirección 500 para conocer este valor y no superar el límite real del buffer.

^ Inicio ^ Longitud ^ Tipo ^ r/w ^ Rango de valores ^ Descripción ^
| 500 | 2 | HR_uint32_t | r | 0 - 0xFFFFFFFF | longitud del buffer utilizado en write() y read()|
| 502 | depende del valor leído en la dirección 500 | HR_uint16_t | r/w | 0 - 0xFFFF | buffer para intercambio de datos. Utilizado como buffer en la funciones read() y write()|


===== Casos de uso =====


</textarea><div id="wiki__editbar" class="editBar"><div id="size__ctl"></div></div></form></div>
                    <!-- wikipage stop -->
                                    </div>

                <div class="docInfo"><bdi>desarrollo/firmware/functional_tests/testslave.txt</bdi> · Última modificación: 2015/09/23 01:11 por <bdi>gmuro</bdi></div>

                
                <hr class="a11y" />
            </div></main><!-- /content -->

            <!-- PAGE ACTIONS -->
            <nav id="dokuwiki__pagetools" aria-labelledby="dokuwiki__pagetools__heading">
                <h3 class="a11y" id="dokuwiki__pagetools__heading">Herramientas de la página</h3>
                <div class="tools">
                    <ul>
                        <li class="show"><a href="http://www.proyecto-ciaa.com.ar/devwiki/doku.php?id=desarrollo:firmware:functional_tests:testslave&amp;do=" title="Ver página [v]" rel="nofollow" accesskey="v"><span>Ver página</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M13 9h5.5L13 3.5V9M6 2h8l6 6v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4c0-1.11.89-2 2-2m9 16v-2H6v2h9m3-4v-2H6v2h12z"/></svg></a></li><li class="revs"><a href="./doku.php%3Fid=desarrollo:firmware:functional_tests:testslave&amp;do=revisions.html" title="Revisiones antiguas [o]" rel="nofollow" accesskey="o"><span>Revisiones antiguas</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M11 7v5.11l4.71 2.79.79-1.28-4-2.37V7m0-5C8.97 2 5.91 3.92 4.27 6.77L2 4.5V11h6.5L5.75 8.25C6.96 5.73 9.5 4 12.5 4a7.5 7.5 0 0 1 7.5 7.5 7.5 7.5 0 0 1-7.5 7.5c-3.27 0-6.03-2.09-7.06-5h-2.1c1.1 4.03 4.77 7 9.16 7 5.24 0 9.5-4.25 9.5-9.5A9.5 9.5 0 0 0 12.5 2z"/></svg></a></li><li class="backlink"><a href="./doku.php%3Fid=desarrollo:firmware:functional_tests:testslave&amp;do=backlink.html" title="Enlaces a esta página" rel="nofollow"><span>Enlaces a esta página</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M10.59 13.41c.41.39.41 1.03 0 1.42-.39.39-1.03.39-1.42 0a5.003 5.003 0 0 1 0-7.07l3.54-3.54a5.003 5.003 0 0 1 7.07 0 5.003 5.003 0 0 1 0 7.07l-1.49 1.49c.01-.82-.12-1.64-.4-2.42l.47-.48a2.982 2.982 0 0 0 0-4.24 2.982 2.982 0 0 0-4.24 0l-3.53 3.53a2.982 2.982 0 0 0 0 4.24m2.82-4.24c.39-.39 1.03-.39 1.42 0a5.003 5.003 0 0 1 0 7.07l-3.54 3.54a5.003 5.003 0 0 1-7.07 0 5.003 5.003 0 0 1 0-7.07l1.49-1.49c-.01.82.12 1.64.4 2.43l-.47.47a2.982 2.982 0 0 0 0 4.24 2.982 2.982 0 0 0 4.24 0l3.53-3.53a2.982 2.982 0 0 0 0-4.24.973.973 0 0 1 0-1.42z"/></svg></a></li><li class="top"><a href="./doku.php%3Fid=desarrollo:firmware:functional_tests:testslave&amp;do=edit.html#dokuwiki__top" title="Volver arriba [t]" rel="nofollow" accesskey="t"><span>Volver arriba</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg></a></li>                    </ul>
                </div>
            </nav>
        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<footer id="dokuwiki__footer"><div class="pad">
    
    <div class="buttons">
                <a href="https://www.dokuwiki.org/donate" title="Donate" target="_blank"><img
            src="lib/tpl/dokuwiki/images/button-donate.gif" width="80" height="15" alt="Donate" /></a>
        <a href="https://php.net" title="Powered by PHP" target="_blank"><img
            src="lib/tpl/dokuwiki/images/button-php.gif" width="80" height="15" alt="Powered by PHP" /></a>
        <a href="http://validator.w3.org/check/referer" title="Valid HTML5" target="_blank"><img
            src="lib/tpl/dokuwiki/images/button-html5.png" width="80" height="15" alt="Valid HTML5" /></a>
        <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS" target="_blank"><img
            src="lib/tpl/dokuwiki/images/button-css.png" width="80" height="15" alt="Valid CSS" /></a>
        <a href="https://dokuwiki.org/" title="Driven by DokuWiki" target="_blank"><img
            src="lib/tpl/dokuwiki/images/button-dw.png" width="80" height="15"
            alt="Driven by DokuWiki" /></a>
    </div>

    </div></footer><!-- /footer -->
    </div></div><!-- /site -->

    <div class="no"><img src="http://www.proyecto-ciaa.com.ar/devwiki/lib/exe/taskrunner.php?id=desarrollo%3Afirmware%3Afunctional_tests%3Atestslave&amp;1700036765" width="2" height="1" alt="" /></div>
    <div id="screen__mode" class="no"></div></body>
</html>
